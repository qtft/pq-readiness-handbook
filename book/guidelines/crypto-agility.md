# ความคล่องตัวด้านระบบรหัสลับ

ความคล่องตัวด้านระบบรหัสลับ (Cryptographic Agility) หมายถึงความสามารถของระบบ องค์กร และโครงสร้างพื้นฐานด้านไอทีในการ เปลี่ยน ปรับ หรือยกเลิกการใช้อัลกอริทึมเข้ารหัสได้อย่างเป็นระบบและทันท่วงที โดยยังคงรักษาความมั่นคงปลอดภัย ความต่อเนื่องของบริการ และความสามารถในการทำงานร่วมกับระบบอื่น (interoperability) เอาไว้ได้ แนวคิดนี้เกิดจากข้อเท็จจริงที่ว่าอัลกอริทึมเข้ารหัสไม่ได้ “ปลอดภัยตลอดไป” แต่มีวงจรชีวิตที่ขึ้นกับพลังประมวลผล เทคนิคการวิเคราะห์การเข้ารหัส (cryptanalysis) และความก้าวหน้าทางวิชาการ

เอกสาร [NIST CSWP 39](https://csrc.nist.gov/pubs/cswp/39/considerations-for-achieving-cryptographic-agility/final) ชี้ให้เห็นว่าที่ผ่านมาอัลกอริทึมคริปโตถูกใช้ปกป้องการสื่อสารและอุปกรณ์ดิจิทัลแทบทุกชนิดมานานหลายทศวรรษ แต่เมื่อความสามารถในการคำนวณเพิ่มขึ้น อัลกอริทึมบางตัวก็เริ่มไม่ปลอดภัยเพียงพอ การเปลี่ยนผ่านอัลกอริทึมจึงเป็นสิ่งที่หลีกเลี่ยงไม่ได้ อย่างไรก็ตาม การเปลี่ยนผ่านแต่ละครั้งมักมีต้นทุนสูง ใช้เวลานาน และกระทบต่อการดำเนินงานจริงขององค์กรอย่างมาก  ￼

การมาถึงของคอมพิวเตอร์ควอนตัมที่มีศักยภาพในการโจมตี public-key cryptography ทำให้สถานการณ์ต่างจากอดีต เพราะไม่ใช่แค่ “บางอัลกอริทึม” ที่ต้องเปลี่ยน แต่เป็น อัลกอริทึม public-key แทบทั้งหมด ที่ต้องย้ายไปสู่ Post-Quantum Cryptography (PQC) นอกจากนี้ NIST ยังเน้นว่าการเปลี่ยนผ่านสู่ PQC จะไม่ใช่ครั้งสุดท้ายในประวัติศาสตร์คริปโต อนาคตยังมีการเปลี่ยนผ่านอีกแน่นอน ดังนั้นองค์กรที่สร้างความสามารถด้าน crypto agility ไว้ล่วงหน้า จะมีต้นทุนและความเสี่ยงต่ำกว่าในระยะยาวอย่างมีนัยสำคัญ  ￼

ในมุมยุทธศาสตร์ องค์กรควรมอง crypto agility เป็นส่วนหนึ่งของ enterprise risk management ไม่ต่างจาก disaster recovery หรือ business continuity เพราะการใช้อัลกอริทึมที่ล้าสมัยอาจนำไปสู่ความเสียหายด้านข้อมูล ความเชื่อมั่น และการปฏิบัติตามกฎระเบียบได้

## บทเรียนจากการเปลี่ยนผ่านคริปโตในอดีต

ประวัติศาสตร์ของคริปโตกราฟีแสดงให้เห็นว่า การเปลี่ยนอัลกอริทึมไม่ใช่เรื่องง่าย ตัวอย่างเช่น การเปลี่ยนจาก DES ไปเป็น 3DES และต่อมาเป็น AES ใช้เวลาหลายสิบปี หรือกรณี SHA-1 ที่ยังถูกใช้อยู่ในระบบจำนวนมากแม้จะทราบจุดอ่อนแล้ว ปัญหาหลักไม่ได้อยู่ที่การ “มีอัลกอริทึมใหม่” แต่คือการทำให้ระบบนับพันนับหมื่นสามารถย้ายไปใช้อัลกอริทึมใหม่ได้จริง

NIST ชี้ว่าระบบในอดีตจำนวนมากถูกออกแบบโดยไม่คิดถึงการเปลี่ยนผ่านในอนาคต อัลกอริทึมถูกฝังแน่นในโค้ด ฮาร์ดแวร์ หรือโปรโตคอล ทำให้เปลี่ยนได้ยาก เมื่อจำเป็นต้องเปลี่ยนจริงจึงเกิดต้นทุนสูงมาก ทั้งในแง่การพัฒนา การทดสอบ และการประสานงานระหว่างหลายฝ่าย อีกทั้งยังติดข้อจำกัดด้าน backward compatibility เพราะระบบใหม่ต้องคุยกับระบบเก่าได้

บทเรียนสำคัญสำหรับองค์กรไทยคือ ระบบที่ไม่ยืดหยุ่นตั้งแต่แรก จะทำให้การย้ายสู่ PQC ในอนาคตมีต้นทุนสูงและเสี่ยงต่อความล่าช้า ซึ่งอาจทำให้ข้อมูลสำคัญตกอยู่ในความเสี่ยงจากแนวคิด “harvest now, decrypt later”

## Crypto Agility ในระดับโปรโตคอลความมั่นคงปลอดภัย

ในระดับ security protocols (เช่น TLS, IPsec) crypto agility เกี่ยวข้องกับความสามารถในการเปลี่ยน cipher suite และอัลกอริทึมต่าง ๆ ได้โดยไม่ทำให้ระบบล่มหรือขาดการเชื่อมต่อ NIST แนะนำให้โปรโตคอลออกแบบแบบ modular เพื่อให้เพิ่มหรือถอดอัลกอริทึมได้ง่าย ไม่ผูกกับอัลกอริทึมตัวใดตัวหนึ่ง

การทำ algorithm negotiation ต้องมี integrity protection เพื่อป้องกัน downgrade attack ที่ผู้โจมตีบังคับให้คู่สื่อสารเลือกอัลกอริทึมที่อ่อนแอกว่า นอกจากนี้ โปรโตคอลควรหลีกเลี่ยงความซับซ้อนเกินจำเป็น เพราะความซับซ้อนเพิ่มโอกาสเกิดช่องโหว่และบั๊กด้านความมั่นคงปลอดภัย

อีกแนวทางสำคัญคือ Hybrid Cryptography ซึ่งใช้ traditional cryptography ควบคู่กับ PQC ในช่วงเปลี่ยนผ่าน วิธีนี้ช่วยลดความเสี่ยงหาก PQC บางตัวในอนาคตพบจุดอ่อน แต่ก็เพิ่มภาระด้านประสิทธิภาพและความซับซ้อนของระบบ และอาจนำไปสู่การเปลี่ยนผ่านรอบที่สองในอนาคต

ดังนั้นองค์กรควรประเมิน trade-off ระหว่าง “ความยืดหยุ่นสูง” กับ “ความซับซ้อนต่ำ” ให้เหมาะกับบริบทของตน

## Crypto Agility ในระดับแอปพลิเคชัน ระบบปฏิบัติการ และฮาร์ดแวร์

NIST ให้ความสำคัญกับการแยกแอปพลิเคชันออกจากรายละเอียดของอัลกอริทึมผ่าน crypto APIs และ cryptographic libraries เพื่อให้แอปเรียกใช้ฟังก์ชันเข้ารหัสโดยไม่ต้องรู้รายละเอียดภายใน วิธีนี้ทำให้สามารถเปลี่ยนอัลกอริทึมในระดับ library ได้โดยไม่ต้องแก้โค้ดแอปทั้งหมด

ในระดับระบบปฏิบัติการและ embedded systems ความท้าทายเพิ่มขึ้น เพราะอัลกอริทึมบางส่วนฝังอยู่ใน kernel หรือ firmware ที่อัปเดตยาก ส่วนในระดับฮาร์ดแวร์ เช่น HSM, TPM หรือ secure elements อัลกอริทึมอาจเปลี่ยนไม่ได้เลยหลังผลิตออกมา ทำให้ต้องวางแผนล่วงหน้าตั้งแต่การเลือกอุปกรณ์

NIST เน้นว่าการอัปเดตในซอฟต์แวร์ทำได้ง่ายกว่าฮาร์ดแวร์มาก ดังนั้นองค์กรควรหลีกเลี่ยงการพึ่งพาอัลกอริทึมที่ฝังตายตัวในฮาร์ดแวร์ หากต้องใช้งานระยะยาว

## Crypto API

Crypto API (Cryptographic Application Programming Interface) เป็นกลไกสำคัญที่ทำให้เกิด Crypto Agility ในทางปฏิบัติ เพราะทำหน้าที่เป็น “ชั้นคั่นกลาง” ระหว่างแอปพลิเคชันกับการทำงานด้านการเข้ารหัสจริง แทนที่แอปพลิเคชันจะเรียกใช้อัลกอริทึมเข้ารหัสโดยตรง แอปจะเรียกใช้ผ่าน API มาตรฐาน ซึ่งไปเชื่อมต่อกับ cryptographic library หรือ cryptographic service provider (CSP) อีกที โครงสร้างลักษณะนี้ช่วยแยกความรับผิดชอบระหว่าง logic ของแอปกับรายละเอียดเชิงคริปโต ทำให้สามารถเปลี่ยนอัลกอริทึมภายในได้โดยไม่ต้องแก้แอปทั้งหมด

NIST อธิบายว่า Crypto API ช่วยให้นักพัฒนาโฟกัสกับงานระดับแอปพลิเคชัน ขณะที่งานเข้ารหัส เช่น symmetric encryption, digital signatures, hashing, random number generation และ key establishment ถูกจัดการโดยไลบรารีหรือผู้ให้บริการคริปโตโดยเฉพาะ แนวทางนี้เปิดโอกาสให้ระบบรองรับทั้งอัลกอริทึมเก่าและใหม่ในช่วงเปลี่ยนผ่านได้พร้อมกัน ซึ่งเป็นหัวใจของ crypto agility  ￼

อีกประเด็นสำคัญคือ ความสม่ำเสมอของ interface หาก Crypto API ออกแบบให้รูปแบบการเรียกใช้งานคล้ายกันระหว่างอัลกอริทึมต่าง ๆ (เช่น AEAD หลายแบบ) การสลับอัลกอริทึมจะทำได้ง่ายขึ้นมาก ตัวอย่างเช่น แอปอาจเรียกฟังก์ชัน “encrypt()” แบบเดียวกัน ไม่ว่าจะใช้อัลกอริทึม A หรือ B การเปลี่ยนผ่านไปสู่อัลกอริทึมใหม่ เช่น PQC-based schemes จึงกระทบต่อโค้ดแอปน้อยที่สุด

NIST ยังชี้ว่าบาง Crypto API มีการ implement โปรโตคอลระดับสูงอย่าง TLS หรือ IPsec มาให้ด้วย ทำให้แอปไม่ต้องจัดการรายละเอียดการต่อรองอัลกอริทึมเอง แอปเพียงระบุรายการอัลกอริทึมที่ยอมรับได้ จากนั้นโปรโตคอลจะทำ negotiation ให้โดยอัตโนมัติ กลไกนี้ช่วยให้องค์กรควบคุมนโยบายด้านอัลกอริทึมจากศูนย์กลางได้ง่ายขึ้น  ￼

ในเชิงการบริหาร นโยบายอัลกอริทึมสามารถผูกกับ Crypto API ได้ เช่น ผู้ดูแลระบบอาจกำหนด policy ว่า “ห้ามใช้ Triple DES สำหรับการเข้ารหัสใหม่” ทำให้คำสั่งเข้ารหัสล้มเหลวทันทีหากเรียกใช้อัลกอริทึมที่ไม่อนุญาต ขณะที่อาจยังอนุญาตให้ถอดรหัสข้อมูลเก่าที่เข้ารหัสไว้ก่อนหน้าได้ วิธีนี้ช่วยเลิกใช้อัลกอริทึมอ่อนแอแบบค่อยเป็นค่อยไปโดยไม่กระทบข้อมูลเดิม

```{figure} ../figures/crypto-api.png
---
name: crypto-api
---
แผนภาพ Functional Diagram ของแอปพลิเคชันที่ใช้งาน Crypto APIs (Source: NIST CSWP 39)
```

## แผนกลยุทธ์ Crypto Agility สำหรับองค์กร

NIST เสนอให้มี Crypto Agility Strategic Plan เพื่อบริหารความเสี่ยงด้านคริปโตในระดับองค์กร โดยประกอบด้วยหลายองค์ประกอบสำคัญ

ด้าน Governance
ควรบูรณาการ crypto agility เข้ากับนโยบายบริหารความเสี่ยงไซเบอร์ กำหนดทิศทาง นโยบาย และความคาดหวังด้านการเข้ารหัสให้ชัดเจน พร้อมสื่อสารไปยังเจ้าของข้อมูล ทีมไอที นักพัฒนา และผู้ขายใน supply chain  ￼

ด้าน Inventory และ Asset Visibility
องค์กรควรทำ crypto inventory ว่ามีการใช้การเข้ารหัสที่ใดบ้าง ตั้งแต่โค้ด ไลบรารี แอป ฮาร์ดแวร์ โปรโตคอล ไปจนถึงบริการองค์กร โดยให้ความสำคัญตามความสำคัญของข้อมูล  ￼

ด้านเครื่องมือและระบบอัตโนมัติ
ควรใช้เครื่องมือช่วยค้นหา ประเมิน และติดตามการใช้อัลกอริทึม รวมถึงขนาดกุญแจ เพื่อให้เห็นภาพรวมและลดการพึ่งพางาน manual

ด้านการจัดลำดับความเสี่ยง
ใช้แนวทาง risk-based prioritization เพื่อเลือกว่าระบบใดควรย้ายก่อน ระบบใดรับความเสี่ยงได้ชั่วคราว

ด้านสถาปัตยกรรมคริปโตระดับองค์กร
ควรกำหนด cryptographic architecture ที่ชัดเจน ครอบคลุมมาตรฐาน นโยบาย การจัดการกุญแจ และการโต้ตอบขององค์ประกอบต่าง ๆ เพื่อให้ตัดสินใจเปลี่ยนหรืออัปเกรดอัลกอริทึมได้ทันเวลาเมื่อมีภัยคุกคามใหม่  ￼

## นัยต่อองค์กรในประเทศไทย

สำหรับองค์กรไทย โดยเฉพาะภาคการเงิน ภาครัฐ และโครงสร้างพื้นฐานสำคัญ การเตรียมพร้อมสู่ยุคควอนตัมควรเริ่มจาก crypto agility ไม่ใช่เริ่มจาก PQC โดยตรง องค์กรที่ยังไม่รู้ด้วยซ้ำว่าใช้อัลกอริทึมใดอยู่ที่ไหน จะย้ายสู่ PQC ได้ยากมาก

แนวทางเริ่มต้นที่เป็นรูปธรรม ได้แก่
- ทำ crypto inventory ระดับองค์กร
- หลีกเลี่ยงการฝังอัลกอริทึมตายตัวในระบบใหม่
- เลือกใช้ระบบที่รองรับ crypto agility
- ผสานเรื่องนี้เข้ากับ cybersecurity roadmap และ digital transformation

ในระยะยาว Crypto Agility จะกลายเป็น “ความสามารถเชิงยุทธศาสตร์” ที่ช่วยให้องค์กรปรับตัวต่อเทคโนโลยีและภัยคุกคามใหม่ได้อย่างยั่งยืน มากกว่าการเป็นเพียงมาตรการทางเทคนิคเฉพาะกิจ