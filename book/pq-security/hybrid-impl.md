# ระบบแบบผสม

ในการวางกลยุทธ์รับมือภัยคุกคามจากคอมพิวเตอร์ควอนตัม องค์กรควรเลือกใช้เทคโนโลยีให้สอดคล้องกับระดับความเสี่ยง มูลค่าของข้อมูล และข้อจำกัดด้านต้นทุนและโครงสร้างพื้นฐาน แนวทางที่เหมาะสมคือการใช้ระบบป้องกันแบบหลายชั้น โดยกำหนดให้ระบบรหัสลับยุคหลังควอนตัม (Post-Quantum Cryptography: PQC) เป็นกลไกหลักในวงกว้าง และพิจารณาใช้เทคโนโลยีการแจกจ่ายกุญแจเชิงควอนตัม (Quantum Key Distribution: QKD) เฉพาะในกรณีที่ต้องการการรับประกันด้านความมั่นคงในระดับสูงเป็นพิเศษ

PQC ควรถูกกำหนดให้เป็นแนวทางการยกระดับความทนทานต่อควอนตัมหลักในระดับทั้งองค์กร
- โซลูชันเชิงซอฟต์แวร์ (Software-Based Solution): อัลกอริทึม PQC ถูกออกแบบให้ทำงานในรูปแบบซอฟต์แวร์ และสามารถบูรณาการเข้ากับโปรโตคอลที่ใช้งานอยู่แล้ว เช่น TLS, IPsec และ SSH ได้โดยง่าย
- ครอบคลุมการใช้งานอย่างกว้างขวาง (Broad Coverage): PQC มีความคุ้มค่าและเหมาะสมกับระบบดิจิทัลแทบทุกประเภท ไม่ว่าจะเป็นเซิร์ฟเวอร์ ระบบคลาวด์ หรืออุปกรณ์ IoT เชิงพาณิชย์ที่มีข้อจำกัดด้านประสิทธิภาพและหน่วยความจำ
- ลดความเสี่ยงแบบ HNDL (Mitigation of HNDL): PQC มีบทบาทสำคัญในการลดความเสี่ยงจากการโจมตีลักษณะ Harvest-Now, Decrypt-Later (HNDL) โดยเฉพาะข้อมูลที่ต้องจัดเก็บและปกป้องในระยะยาว

QKD ควรถูกนำมาใช้ในสภาพแวดล้อมแบบจุดต่อจุดที่มีมูลค่าสูง ซึ่งการรับประกันการแลกเปลี่ยนกุญแจเชิงฟิสิกส์เป็นข้อกำหนดด้านความมั่นคงที่จำเป็น
- ลิงก์โครงสร้างพื้นฐานสำคัญ (Critical Links): เช่น ระบบด้านการป้องกันประเทศ การสื่อสารของหน่วยงานรัฐที่มีชั้นความลับสูง โครงข่ายการเงินระหว่างธนาคาร และการเชื่อมต่อข้ามพรมแดน
- การลงทุนด้านโครงสร้างพื้นฐาน (Infrastructure Investment): QKD ต้องอาศัยการลงทุนสูงในโครงข่ายใยแก้วนำแสงเฉพาะทางหรือระบบดาวเทียม จึงไม่เหมาะสมและไม่คุ้มค่าสำหรับการใช้งานในระบบองค์กรทั่วไป
- ความทนทานแบบหลายชั้น (Layered Resilience): การผสานกุญแจจาก PQC KEMs เข้ากับกุญแจที่ได้จาก QKD จะช่วยเสริมความมั่นคงแบบหลายชั้น และให้ระดับความเชื่อมั่นด้านความปลอดภัยสูงสุดเท่าที่เทคโนโลยีในปัจจุบันรองรับได้

โดยสรุป การสร้างความมั่นคงปลอดภัยของระบบสารสนเทศในยุคควอนตัมไม่สามารถพึ่งพาเทคโนโลยีใดเทคโนโลยีหนึ่งได้เพียงลำพัง เนื่องจากระบบรหัสลับแบบดั้งเดิม PQC และเทคโนโลยี QKD ต่างมีจุดแข็ง ข้อจำกัด และขอบเขตการใช้งานที่แตกต่างกัน ระบบรหัสลับแบบดั้งเดิมยังคงมีบทบาทสำคัญในด้านประสิทธิภาพ ความเข้ากันได้ และเสถียรภาพของระบบที่ใช้งานอยู่ ขณะที่ PQC ช่วยยกระดับความทนทานต่อการโจมตีจากคอมพิวเตอร์ควอนตัมในวงกว้างและสามารถปรับใช้ได้อย่างคุ้มค่า ส่วน QKD ให้การรับประกันด้านความมั่นคงเชิงฟิสิกส์ในกรณีที่ต้องการระดับความปลอดภัยสูงเป็นพิเศษ ดังนั้น แนวทางที่เหมาะสมที่สุดคือการผสานเทคโนโลยีทั้งสามเข้าด้วยกันในลักษณะการป้องกันแบบหลายชั้น เพื่อให้ระบบสามารถรองรับภัยคุกคามในปัจจุบันและอนาคตได้อย่างสมดุลและยั่งยืน

## ระบบแบบผสม Classical และ PQC
การเปลี่ยนผ่านระบบรหัสลับไปสู่ยุควอนตัม (Post-Quantum Cryptography - PQC) อาจเริ่มต้นด้วยการใช้โพรโตคอลระบบรหัสลับแบบผสม (PQC-Classical Hybrid Protocols) ระหว่างระบบรหัสลับแบบดั่งเดิมที่เปราะบางต่อการโจมตีจากคอมพิวเตอร์ควอนตัม (Quantum-vulnerable) และแบบใหม่ที่มีความทนทาร (Quantum-resistant) ทั้งสำหรับการสร้างกุญแจรหัสลับร่วมกัน (Key Establishment) และการลงลายมือชื่อดิจิทัล (Digital Signature) 

ระบบรหัสลับแบบผสมสามารถนำมาใช้ เพื่อป้องกันความเสี่ยงจากข้อบกพร่องหรือข้อผิดพลาดในการใช้งานในอัลกอริทึมใดอัลกอริทึมหนึ่ง นอกจากนี้ ระบบรหัสลับแบบผสมยังสามารถนำมาใช้ในกรณี หรือ อุตสาหกรรมที่ยังมีความจำเป็นต้องใช้อัลกอริทึมแบบดั่งเดิมในระหว่างช่วงการเปลี่ยนผ่านนี้

ระบบรหัสลับแบบผสมมีข้อด้อยนั้นคือเพิ่มความซับซ้อนให้กับการใช้งานและสถาปัตยกรรมซอฟต์แวร์ ซึ่งอาจเพิ่มความเสี่ยงด้านความมั่นคงปลอดภัยและเพิ่มต้นทุน ทำให้ระบบรหัสลับแบบผสมนั้นควรใช้เป็นเพียงมาตรการชั่วคราวเท่านั้น ผู้พัฒนาระบบและองค์กรจำเป็นต้องพิจารณาอย่างรอบคอบถึงความปลอดภัย ต้นทุน และความซับซ้อนของระบบรหัสลับแบบผสมในสภาพแวดล้อมการใช้งานจริง

ทั้งนี้ ไม่ว่าระบบรหัสลับแบบผสมจะถูกนำไปใช้งานจริงหรือไม่ อัลกอริทึมระบบรหัสแบบดั่งเดิมและแบบยุคควอนตัม จะถูกใช้งานควบคู่กันในหลายแอปพลิเคชันและระบบระหว่างการเปลี่ยนผ่านไปสู่ยุคควอนตัม ตัวอย่างเช่น โปรโตคอลความปลอดภัยของเครือข่ายหลายตัวรองรับการใช้งานชุดอัลกอริทึมระบบรหัสหลายชุดและอนุญาตให้คู่สื่อสารเจรจาเลือกใช้อัลกอริทึมที่ต้องการในแต่ละเซสชันได้ โดยไม่ถือว่าเป็นระบบรหัสแบบผสม เพราะว่าแต่ละเซสชันใช้อัลกอริทึมระบบรหัสเพียงชุดเดียว

### การสร้างกุญแจรหัสลับร่วมกันแบบผสม
การสร้างกุญแจรหัสลับร่วมกันแบบผสม (Hybrid Key-Establishment) ประกอบไปด้วยองค์ประกอบอย่างน้อยสองส่วน ซึ่งแต่ละองค์ประกอบสร้างกุญแจรหัสลับแยกกัน และ ผลลัพธ์ของกุญแจรหัสลับคือการผสมรวมกุญแจจากองค์ประกอบเหล่านี้  โดยมีคุณสมบัติที่สำคัญ  คือ กุญแจระบบรหัสที่ถูกสร้างขึ้นจะมีความมั่นคงปลอดภัย หากระบบรหัสตัวใดตัวหนึ่งที่เป็นองค์ประกอบยังคงมีความมั่นคงปลอดภัย 
กุญแจรหัสลับที่ถูกสร้างจากระบบรหัสลับสำหรับยยุคควอนตัมตามที่ระบุในมาตรฐาน FIPS 203 สามารถนำมาใช้เป็นองค์ประกอบหนึ่งร่วมกันกับระบบรหัสลับแบบดั่งเดิมได้ ทำให้กุญแจผลลัพธ์มีความปลอดภัยจากการโจมตีด้วยคอมพิวเตอร์ควอนตัม

### การลงลายมือชื่อดิจิทัลแบบผสม 
การลงลายมือชื่อดิจิทัลแบบผสม (Hybrid Digital Signatures) เป็นการลงลายมือชื่อคู่ (dual signatures) ซึ่งประกอบไปด้วยลายมือชื่ออย่างน้อยสองอันลงบนข้อความชุดเดียวกัน โดยการตรวจสอบความถูกต้องของลายมือชื่อผสม ต้องดำเนินการตรวจสอบลายมือชื่อแต่ละส่วนแยกกันทั้งหมด โดยลายมือชื่อแบบผสมสามารถนำมาใช้เพื่อลงนามข้อมูลของผู้ใช้งาน เช่น เอกสาร อีเมล หรือ ใบรับรองอิเล็กทรอนิกส์ 

## ระบบแบบผสม PQC และ QKD

การพัฒนาระบบสารสนเทศให้ทนทานต่อการโจมตีจากคอมพิวเตอร์ควอนตัมสามารถดำเนินการได้หลายแนวทาง โดยควรผสานเทคโนโลยีที่มีจุดเด่นแตกต่างกันเพื่อเสริมความมั่นคงโดยรวม การใช้ระบบรหัสลับแบบผสมระหว่างอัลกอริทึมแบบดั้งเดิมและระบบรหัสลับยุคหลังควอนตัม (Post-Quantum Cryptography: PQC) เป็นแนวทางที่ได้รับการยอมรับจากหน่วยงานมาตรฐาน เช่น ANSSI, BSI และ IETF เนื่องจากช่วยให้การเปลี่ยนผ่านเป็นไปอย่างราบรื่นและลดความเสี่ยงในช่วงเปลี่ยนผ่าน ตัวอย่างเช่น RFC 9370 ของ IETF ได้กำหนดให้ IKEv2 ใช้การแลกเปลี่ยนกุญแจแบบผสมเพื่อสร้างกุญแจรหัสลับสุดท้าย{cite:p}`bsi2023quantum` {cite:p}`qedc2022guide`

โดยทั่วไป PQC ควรถูกนำมาใช้เป็นแนวทางหลักในระดับองค์กร เนื่องจากเป็นโซลูชันเชิงซอฟต์แวร์ที่สามารถบูรณาการเข้ากับโปรโตคอลเดิมได้ง่าย ครอบคลุมระบบดิจิทัลหลากหลายประเภท และมีบทบาทสำคัญในการลดความเสี่ยงจากการโจมตีแบบ Harvest-Now, Decrypt-Later (HNDL) ในขณะที่เทคโนโลยีการแจกจ่ายกุญแจเชิงควอนตัม (Quantum Key Distribution: QKD) ควรถูกใช้เฉพาะในสภาพแวดล้อมที่มีมูลค่าสูงและต้องการการรับประกันด้านความมั่นคงเชิงฟิสิกส์ เช่น การสื่อสารภาครัฐหรือโครงข่ายการเงินหลัก เนื่องจากมีต้นทุนและข้อจำกัดด้านโครงสร้างพื้นฐานสูง ทั้งนี้ การใช้ PQC ร่วมกับ QKD จะช่วยสร้างการป้องกันแบบหลายชั้นและเพิ่มความทนทานของระบบในภาพรวม

```{figure} ../figures/hybrid-pqc-qkd.png
---
name: hybrid-pqc-qkd
---
ตัวอย่างระบบแบบผสม PQC และ QKD สำหรับ Data Center และ Disaster Recovery ขององค์กร (Source: A Guide to a Quantum-Safe Organization, QED-C, 2022)
```